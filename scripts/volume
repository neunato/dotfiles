#!/bin/dash

# volume                    - get current volume
# volume up   [--silent]    - turn up volume by 10%
# volume down [--silent]    - turn down volume by 10%
# volume <n>  [--silent]    - set volume to wanted %
# volume mute               - toggle mute

get_volume() {
   wpctl get-volume @DEFAULT_SINK@ | awk '{printf $2*100}'
}

set_volume() {
   wpctl set-volume -l 1.0 @DEFAULT_SINK@ "$1"
   if [ "$2" != "--silent" ]; then
      notify-send "Volume" -h "int:value:$(get_volume)" -h string:x-dunst-stack-tag:progress
   fi
}

if [ -z "$1" ]; then
   get_volume
   echo ""
   exit
fi

if [ "$1" = "up" ]; then
   set_volume 10%+ "$2"
   exit
fi

if [ "$1" = "down" ]; then
   set_volume 10%- "$2"
   exit
fi

if [ "$1" -eq "$1" ] 2> /dev/null; then
   set_volume "$1%" "$2"
   exit
fi

if [ "$1" = "mute" ]; then
   wpctl set-mute @DEFAULT_SINK@ toggle
   exit
fi

echo "Expected 'volume [up|down|<n>|mute]'" >&2
exit 1
